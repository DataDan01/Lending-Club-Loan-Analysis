"0","# Aggregating up by state"
"0","loan_by_state <- loan_data %>% "
"0","                 group_by(addr_state) %>%"
"0","                 summarize(`Total Loans ($)` = sum(loan_amnt)/1e6) %>%"
"0","                 arrange(desc(`Total Loans ($)`))"
"0","colnames(loan_by_state) <- c(""region"",""value"")"
"0","# Getting summary percentage of top 4 regions"
"0","top4_states <- round(100*sum(loan_by_state$value[1:4])/sum(loan_by_state$value),1)"
"0","# Replacing out the state codes with their full names for plotting"
"0","lib_load(""rgdal"")"
"0","lib_load(""choroplethrMaps"")"
"0","lib_load(""choroplethr"") # hit ""n"" when installing the sf package, seems to be a bug"
"0","data(""state.regions"")"
"0","loan_by_state$region <- sapply(loan_by_state$region, function(state_code) {"
"0","  "
"0","  inx <- grep(pattern = state_code, x = state.regions$abb)"
"0","  "
"0","  state.regions$region[inx]"
"0","  "
"0","})"
"0","# Plotting US map with values"
"0","state_choropleth(loan_by_state, title = ""           Total Loan Volume by State - Millions $"")"
