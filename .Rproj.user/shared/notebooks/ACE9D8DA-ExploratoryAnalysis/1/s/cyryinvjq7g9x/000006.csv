"0","# Extracting categorical variables"
"0","cat_info <- lapply(1:sum(all_vars == ""character""), function(inx) {"
"0","  "
"0","  Category <- loan_data[,names(all_vars[all_vars == ""character""])[inx]]"
"0","  "
"0","  # Getting frequency counts and sorting in decreasing order"
"0","  counts_df <- data.frame(table(Category)) %>% arrange(desc(Freq))"
"0","  counts_df$Category <- as.character(counts_df$Category)"
"0","  "
"0","  # Summarizing only top 4 counts and lumping everything into a fifth category, Other"
"0","  if(nrow(counts_df) > 5) {"
"0","    "
"0","   counts_df$Freq[5] <- sum(counts_df$Freq[5:nrow(counts_df)])"
"0","   counts_df$Category[5] <- ""Other"""
"0","   "
"0","   counts_df <- counts_df[1:5,]"
"0","  } "
"0","    "
"0","  df <- data.frame(Name = names(all_vars[all_vars == ""character""])[inx],"
"0","                   counts_df, stringsAsFactors = F)"
"0","  df$`Freq %` <- round(100*df$Freq/sum(df$Freq))"
"0","  "
"0","  df"
"0","  "
"0","}) %>% bind_rows()"
"0","# Saving example of an incorrectly tagged NA"
"0","bad_row <- which(loan_data$emp_title == ""."")"
"0","# Formatting into interactive HTML table"
"0","datatable(cat_info)"
